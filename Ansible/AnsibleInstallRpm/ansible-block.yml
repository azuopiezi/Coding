---
- hosts: all

  tasks:
    - name: judge file is exits
      shell: ls /opt/block.txt
      ignore_errors: True
      register: file_result

    - name: if file no exits create a file
      file: path=/opt/block.txt state=touch mode=0777
      when: file_result|failed

    - name: insert lineinfile in file
      marker: "ANSIBLE INJECTED  NODE SSH FOR "
      blockinfile:
        dest: /opt/block.txt
        block: |
          block1
          block2
          block3
